<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Órdenes</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Gestión de Órdenes</h1>
    <form id="create-order-form">
        <h3>Crear Nueva Orden</h3>
        <label for="order-customer-id">ID del Cliente:</label>
        <input type="number" id="order-customer-id" name="customerId" required><br>
        <label for="order-products">Productos (IDs separados por coma):</label>
        <input type="text" id="order-products" name="products" required><br>
        <label for="order-quantities">Cantidades (separadas por coma):</label>
        <input type="text" id="order-quantities" name="quantities" required><br>
        <label for="order-total">Total:</label>
        <input type="number" id="order-total" name="total" required><br>
        <button type="submit">Crear Orden</button>
    </form>

    <form id="get-order-form">
        <h3>Obtener Detalles de una Orden</h3>
        <label for="order-id">ID de la Orden:</label>
        <input type="number" id="order-id" name="id" required><br>
        <button type="submit">Obtener Detalles</button>
    </form>
    <div id="order-details"></div>

    <form id="update-order-form">
        <h3>Actualizar Estado de la Orden</h3>
        <label for="update-order-id">ID de la Orden:</label>
        <input type="number" id="update-order-id" name="id" required><br>
        <label for="update-order-status">Estado:</label>
        <input type="text" id="update-order-status" name="status" required><br>
        <button type="submit">Actualizar Orden</button>
    </form>

    <form id="delete-order-form">
        <h3>Eliminar Orden</h3>
        <label for="delete-order-id">ID de la Orden:</label>
        <input type="number" id="delete-order-id" name="id" required><br>
        <button type="submit">Eliminar Orden</button>
    </form>

    <script>
        document.getElementById('create-order-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const products = e.target.products.value.split(',').map(id => parseInt(id.trim()));
            const quantities = e.target.quantities.value.split(',').map(qty => parseInt(qty.trim()));
            const data = {
                customerId: e.target.customerId.value,
                products,
                quantities,
                total: e.target.total.value
            };
            const response = await fetch('/orders', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });
            if (response.ok) {
                alert('Orden creada exitosamente');
                e.target.reset();
            } else {
                alert('Error al crear orden');
            }
        });

        document.getElementById('get-order-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const orderId = e.target['id'].value;
            const response = await fetch(`/orders/${orderId}`);
            if (response.ok) {
                const order = await response.json();
                document.getElementById('order-details').innerText = JSON.stringify(order, null, 2);
            } else {
                alert('Error al obtener detalles de la orden');
            }
        });

        document.getElementById('update-order-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const orderId = e.target['id'].value;
            const data = {
                status: e.target['status'].value
            };
            const response = await fetch(`/orders/${orderId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });
            if (response.ok) {
                alert('Estado de la orden actualizado exitosamente');
                e.target.reset();
            } else {
                alert('Error al actualizar estado de la orden');
            }
        });

        document.getElementById('delete-order-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const orderId = e.target['id'].value;
            const response = await fetch(`/orders/${orderId}`, {
                method: 'DELETE'
            });
            if (response.ok) {
                alert('Orden eliminada exitosamente');
                e.target.reset();
            } else {
                alert('Error al eliminar orden');
            }
        });
    </script>
</body>
</html>
